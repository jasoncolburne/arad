"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[489],{5489:function(e,n,t){t.r(n),t.d(n,{default:function(){return be}});var r=t(8214),a=t(5861),i=t(885),o=t(2791),s=t(8735),c=t(6871),u=t(1644),l=t(6981),d=t(7963),f=t(3845),v=t(6988),p=t(3209),h=t(5971);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},m.apply(this,arguments)}function k(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}var b=["className"],g=["placement"],y=["isNumeric"],C=(0,p.eC)("Table"),x=C[0],w=C[1],E=(0,p.Gp)((function(e,n){var t=(0,p.jC)("Table",e),r=(0,p.Lr)(e),a=r.className,i=k(r,b);return o.createElement(x,{value:t},o.createElement(p.m$.table,m({role:"table",ref:n,__css:t.table,className:(0,h.cx)("chakra-table",a)},i)))}));h.Ts&&(E.displayName="Table");var P=(0,p.Gp)((function(e,n){var t=e.placement,r=void 0===t?"bottom":t,a=k(e,g),i=w();return o.createElement(p.m$.caption,m({},a,{ref:n,__css:m({},i.caption,{captionSide:r})}))}));h.Ts&&(P.displayName="TableCaption");var j=(0,p.Gp)((function(e,n){var t=w();return o.createElement(p.m$.tbody,m({},e,{ref:n,__css:t.tbody}))})),_=(0,p.Gp)((function(e,n){var t=w();return o.createElement(p.m$.tr,m({role:"row"},e,{ref:n,__css:t.tr}))})),S=(0,p.Gp)((function(e,n){var t=e.isNumeric,r=k(e,y),a=w();return o.createElement(p.m$.td,m({role:"gridcell"},r,{ref:n,__css:a.td,"data-is-numeric":t}))})),B=t(5798),Z=t(9611),I=t(4083),L=t(5223),D=t(3606),M=t(1856),T=t(3393),N=t(1212),O=!1,A=null,G=!1,$=new Set,R="undefined"!==typeof window&&null!=window.navigator&&/^Mac/.test(window.navigator.platform);function F(e,n){$.forEach((function(t){return t(e,n)}))}function z(e){G=!0,function(e){return!(e.metaKey||!R&&e.altKey||e.ctrlKey)}(e)&&(A="keyboard",F("keyboard",e))}function K(e){A="pointer","mousedown"!==e.type&&"pointerdown"!==e.type||(G=!0,F("pointer",e))}function q(e){e.target!==window&&e.target!==document&&(G||(A="keyboard",F("keyboard",e)),G=!1)}function U(){G=!1}function V(){return"pointer"!==A}function W(e){!function(){if("undefined"!==typeof window&&!O){var e=HTMLElement.prototype.focus;HTMLElement.prototype.focus=function(){G=!0;for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];e.apply(this,t)},document.addEventListener("keydown",z,!0),document.addEventListener("keyup",z,!0),window.addEventListener("focus",q,!0),window.addEventListener("blur",U,!1),"undefined"!==typeof PointerEvent?(document.addEventListener("pointerdown",K,!0),document.addEventListener("pointermove",K,!0),document.addEventListener("pointerup",K,!0)):(document.addEventListener("mousedown",K,!0),document.addEventListener("mousemove",K,!0),document.addEventListener("mouseup",K,!0)),O=!0}}(),e(V());var n=function(){return e(V())};return $.add(n),function(){$.delete(n)}}function H(){return H=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},H.apply(this,arguments)}var X=(0,Z.kr)({name:"CheckboxGroupContext",strict:!1}),Y=(X[0],X[1]);function J(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}h.Ts;var Q=["isIndeterminate","isChecked"];var ee=function(e){var n=D.E;return"custom"in n&&"function"===typeof n.custom?n.custom(e):n(e)}(p.m$.svg),ne=function(e){return o.createElement(ee,H({width:"1.2em",viewBox:"0 0 12 10",variants:{unchecked:{opacity:0,strokeDashoffset:16},checked:{opacity:1,strokeDashoffset:0,transition:{duration:.2}}},style:{fill:"none",strokeWidth:2,stroke:"currentColor",strokeDasharray:16}},e),o.createElement("polyline",{points:"1.5 6 4.5 9 10.5 1"}))},te=function(e){return o.createElement(ee,H({width:"1.2em",viewBox:"0 0 24 24",variants:{unchecked:{scaleX:.65,opacity:0},checked:{scaleX:1,opacity:1,transition:{scaleX:{duration:0},opacity:{duration:.02}}}},style:{stroke:"currentColor",strokeWidth:4}},e),o.createElement("line",{x1:"21",x2:"3",y1:"12",y2:"12"}))},re=function(e){var n=e.open,t=e.children;return o.createElement(M.M,{initial:!1},n&&o.createElement(D.E.div,{variants:{unchecked:{scale:.5},checked:{scale:1}},initial:"unchecked",animate:"checked",exit:"unchecked",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},t))},ae=function(e){var n=e.isIndeterminate,t=e.isChecked,r=J(e,Q),a=n?te:ne;return o.createElement(re,{open:t||n},o.createElement(a,r))},ie=["defaultChecked","isChecked","isFocusable","onChange","isIndeterminate","name","value","tabIndex","aria-label","aria-labelledby","aria-invalid"];function oe(e){e.preventDefault(),e.stopPropagation()}var se=["spacing","className","children","iconColor","iconSize","icon","isChecked","isDisabled","onChange","inputProps"],ce=(0,p.m$)("span",{baseStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",userSelect:"none",flexShrink:0}}),ue=(0,p.m$)("label",{baseStyle:{cursor:"pointer",display:"inline-flex",alignItems:"center",verticalAlign:"top",position:"relative"}}),le=(0,p.Gp)((function(e,n){var t=Y(),r=H({},t,e),a=(0,p.jC)("Checkbox",r),i=(0,p.Lr)(e),s=i.spacing,c=void 0===s?"0.5rem":s,u=i.className,l=i.children,d=i.iconColor,f=i.iconSize,v=i.icon,m=void 0===v?o.createElement(ae,null):v,k=i.isChecked,b=i.isDisabled,g=void 0===b?null==t?void 0:t.isDisabled:b,y=i.onChange,C=i.inputProps,x=J(i,se),w=k;null!=t&&t.value&&i.value&&(w=t.value.includes(i.value));var E=y;null!=t&&t.onChange&&i.value&&(E=(0,h.PP)(t.onChange,y));var P=function(e){void 0===e&&(e={});var n=(0,T.Kn)(e),t=n.isDisabled,r=n.isReadOnly,a=n.isRequired,i=n.isInvalid,s=n.id,c=n.onBlur,u=n.onFocus,l=n["aria-describedby"],d=e,f=d.defaultChecked,v=d.isChecked,p=d.isFocusable,m=d.onChange,k=d.isIndeterminate,b=d.name,g=d.value,y=d.tabIndex,C=void 0===y?void 0:y,x=d["aria-label"],w=d["aria-labelledby"],E=d["aria-invalid"],P=J(d,ie),j=(0,h.CE)(P,["isDisabled","isReadOnly","isRequired","isInvalid","id","onBlur","onFocus","aria-describedby"]),_=(0,I.u)(m),S=(0,I.u)(c),B=(0,I.u)(u),D=(0,o.useState)(!1),M=D[0],O=D[1],A=(0,L.kt)(),G=A[0],$=A[1],R=(0,L.kt)(),F=R[0],z=R[1],K=(0,L.kt)(),q=K[0],U=K[1];(0,o.useEffect)((function(){return W(O)}),[]);var V=(0,o.useRef)(null),X=(0,o.useState)(!0),Y=X[0],Q=X[1],ee=(0,o.useState)(!!f),ne=ee[0],te=ee[1],re=(0,L.pY)(v,ne),ae=re[0],se=re[1],ce=(0,o.useCallback)((function(e){r||t?e.preventDefault():(ae||te(se?e.target.checked:!!k||e.target.checked),null==_||_(e))}),[r,t,se,ae,k,_]);(0,I.a)((function(){V.current&&(V.current.indeterminate=Boolean(k))}),[k]),(0,L.rf)((function(){t&&$.off()}),[t,$]),(0,I.a)((function(){var e=V.current;null!=e&&e.form&&(e.form.onreset=function(){te(!!f)})}),[]);var ue=t&&!p,le=(0,o.useCallback)((function(e){" "===e.key&&U.on()}),[U]),de=(0,o.useCallback)((function(e){" "===e.key&&U.off()}),[U]);(0,I.a)((function(){V.current&&V.current.checked!==se&&te(V.current.checked)}),[V.current]);var fe=(0,o.useCallback)((function(e,n){return void 0===e&&(e={}),void 0===n&&(n=null),H({},e,{ref:n,"data-active":(0,h.PB)(q),"data-hover":(0,h.PB)(F),"data-checked":(0,h.PB)(se),"data-focus":(0,h.PB)(G),"data-focus-visible":(0,h.PB)(G&&M),"data-indeterminate":(0,h.PB)(k),"data-disabled":(0,h.PB)(t),"data-invalid":(0,h.PB)(i),"data-readonly":(0,h.PB)(r),"aria-hidden":!0,onMouseDown:(0,h.v0)(e.onMouseDown,(function(e){G&&e.preventDefault(),U.on()})),onMouseUp:(0,h.v0)(e.onMouseUp,U.off),onMouseEnter:(0,h.v0)(e.onMouseEnter,z.on),onMouseLeave:(0,h.v0)(e.onMouseLeave,z.off)})}),[q,se,t,G,M,F,k,i,r,U,z.off,z.on]),ve=(0,o.useCallback)((function(e,n){return void 0===e&&(e={}),void 0===n&&(n=null),H({},j,e,{ref:(0,Z.lq)(n,(function(e){e&&Q("LABEL"===e.tagName)})),onClick:(0,h.v0)(e.onClick,(function(){var e;Y||(null==(e=V.current)||e.click(),(0,h.T_)(V.current,{nextTick:!0}))})),"data-disabled":(0,h.PB)(t),"data-checked":(0,h.PB)(se),"data-invalid":(0,h.PB)(i)})}),[j,t,se,i,Y]),pe=(0,o.useCallback)((function(e,n){return void 0===e&&(e={}),void 0===n&&(n=null),H({},e,{ref:(0,Z.lq)(V,n),type:"checkbox",name:b,value:g,id:s,tabIndex:C,onChange:(0,h.v0)(e.onChange,ce),onBlur:(0,h.v0)(e.onBlur,S,$.off),onFocus:(0,h.v0)(e.onFocus,B,$.on),onKeyDown:(0,h.v0)(e.onKeyDown,le),onKeyUp:(0,h.v0)(e.onKeyUp,de),required:a,checked:se,disabled:ue,readOnly:r,"aria-label":x,"aria-labelledby":w,"aria-invalid":E?Boolean(E):i,"aria-describedby":l,"aria-disabled":t,style:N.NL})}),[b,g,s,ce,$.off,$.on,S,B,le,de,a,se,ue,r,x,w,E,i,l,t,C]),he=(0,o.useCallback)((function(e,n){return void 0===e&&(e={}),void 0===n&&(n=null),H({},e,{ref:n,onMouseDown:(0,h.v0)(e.onMouseDown,oe),onTouchStart:(0,h.v0)(e.onTouchStart,oe),"data-disabled":(0,h.PB)(t),"data-checked":(0,h.PB)(se),"data-invalid":(0,h.PB)(i)})}),[se,t,i]);return{state:{isInvalid:i,isFocused:G,isChecked:se,isActive:q,isHovered:F,isIndeterminate:k,isDisabled:t,isReadOnly:r,isRequired:a},getRootProps:ve,getCheckboxProps:fe,getInputProps:pe,getLabelProps:he,htmlProps:j}}(H({},x,{isDisabled:g,isChecked:w,onChange:E})),j=P.state,_=P.getInputProps,S=P.getCheckboxProps,B=P.getLabelProps,D=P.getRootProps,M=o.useMemo((function(){return H({opacity:j.isChecked||j.isIndeterminate?1:0,transform:j.isChecked||j.isIndeterminate?"scale(1)":"scale(0.95)",fontSize:f,color:d},a.icon)}),[d,f,j.isChecked,j.isIndeterminate,a.icon]),O=o.cloneElement(m,{__css:M,isIndeterminate:j.isIndeterminate,isChecked:j.isChecked});return o.createElement(ue,H({__css:a.container,className:(0,h.cx)("chakra-checkbox",u)},D()),o.createElement("input",H({className:"chakra-checkbox__input"},_(C,n))),o.createElement(ce,H({__css:a.control,className:"chakra-checkbox__control"},S()),O),l&&o.createElement(p.m$.span,H({className:"chakra-checkbox__label"},B(),{__css:H({marginStart:c},a.label)}),l))}));h.Ts&&(le.displayName="Checkbox");var de=t(184),fe=function(e){var n=e.user,t=e.roles,i=(0,f.j1)(),o=i.state,s=i.setState,c=function(e){if([401,403].includes(e.status)){var n=(0,f.C5)(o,l.G.Administrator,"");s(n)}},d=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,a){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={user_id:n.id,role:a,action:t?l.$.Assign:l.$.Revoke},e.next=3,(0,u.V)().put("identify/role",o.credentials.access_tokens.administrator,i,c);case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),v="users-email-".concat(n.id);return(0,de.jsxs)(_,{children:[(0,de.jsx)(S,{id:v,children:n.email},v),t.map((function(e){var t=n.roles.includes(e),r="users-roleToggle-".concat(n.id,"-").concat(e);return(0,de.jsx)(S,{children:(0,de.jsx)(le,{id:r,colorScheme:"gray",size:"lg",defaultChecked:t,onChange:function(n){d(n.target.checked,e)}})},r)}))]})},ve=t(2504),pe=function(e){var n=e.content,t=e.disabled,r=e.onClick;return(0,de.jsx)(ve.zx,{verticalAlign:"center",disabled:t,onClick:r,children:n})},he=function(e){var n=e.page,t=e.setPage,r=e.totalPages,a=e.children;return(0,de.jsxs)(s.Ug,{verticalAlign:"center",children:[(0,de.jsx)(pe,{content:"<",disabled:n<=1,onClick:function(e){t(n-1)}}),a,(0,de.jsx)(pe,{content:">",disabled:n>=r,onClick:function(e){t(n+1)}})]})},me=function(e){var n=e.users,t=e.roles,r=e.setFilterText,a=e.page,s=e.setPage,c=e.totalPages,u=o.useState(null),l=(0,i.Z)(u,2),d=l[0],f=l[1];return(0,de.jsx)(he,{page:a,totalPages:c,setPage:s,children:(0,de.jsx)(E,{id:"users-list",children:(0,de.jsxs)(j,{children:[(0,de.jsxs)(_,{children:[(0,de.jsx)(S,{children:(0,de.jsx)(B.II,{id:"users-filter",borderRadius:"lg",focusBorderColor:"black",placeholder:"email filter",onChange:function(e){d&&clearTimeout(d);var n=setTimeout((function(){r(e.target.value),s(1),f(null)}),666);f(n)}})},"email-filter"),t.map((function(e){return(0,de.jsx)(S,{children:e},e)}))]}),n.map((function(e){var n="users-row-".concat(e.id);return(0,de.jsx)(fe,{user:e,roles:t},n)}))]})})})},ke=t(2213),be=function(){var e=(0,f.j1)(),n=e.state,t=e.setState,p=o.useState([]),h=(0,i.Z)(p,2),m=h[0],k=h[1],b=o.useState([]),g=(0,i.Z)(b,2),y=g[0],C=g[1],x=o.useState(""),w=(0,i.Z)(x,2),E=w[0],P=w[1],j=o.useState(1),_=(0,i.Z)(j,2),S=_[0],B=_[1],Z=o.useState(1),I=(0,i.Z)(Z,2),L=I[0],D=I[1],M=o.useState(""),T=(0,i.Z)(M,2),N=T[0],O=T[1],A=o.useState(!1),G=(0,i.Z)(A,2),$=G[0],R=G[1],F=o.useState(!1),z=(0,i.Z)(F,2),K=z[0],q=z[1],U=o.useState(!1),V=(0,i.Z)(U,2),W=V[0],H=V[1],X=o.useState(!1),Y=(0,i.Z)(X,2),J=Y[0],Q=Y[1],ee=o.useState(!1),ne=(0,i.Z)(ee,2),te=ne[0],re=ne[1],ae=(0,c.s0)(),ie=(0,v.Pl)(n.credentials)&&(0,v.lA)(n.user.roles),oe=ie&&(0,v.WW)(n.credentials.access_tokens.administrator);return o.useEffect((function(){var e=function(e){[401,403].includes(e.status)?(t(d.Z),ae("/login")):P("something went wrong")},i=function(){var i=(0,a.Z)((0,r.Z)().mark((function a(i){var o,s;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.V)().post("identify/token",null,i,e);case 2:void 0!==(o=r.sent)&&(s=(0,f.C5)(n,l.G.Administrator,o.access_token),t(s)),R(!1);case 5:case"end":return r.stop()}}),a)})));return function(e){return i.apply(this,arguments)}}();if(ie&&!oe&&!$){var o={refresh_token:n.credentials.refresh_token,scope:l.G.Administrator};R(!0),i(o)}}),[ie,oe,$,t,ae]),o.useEffect((function(){var e=function(e){if([401,403].includes(e.status)){var r=(0,f.C5)(n,l.G.Administrator,"");t(r),P("not authorized")}else P("something went wrong")},i=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(t,a){var i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,u.V)().post("identify/users",a,t,e);case 2:void 0!==(i=n.sent)&&(k(i.users),D(i.pages),re(!0),J&&P("")),H(!1);case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();if(oe&&!W){var o={email_filter:N,page:S};re(!1),H(!0),i(o,n.credentials.access_tokens.administrator)}}),[S,N,oe,t]),o.useEffect((function(){var e=function(e){if([401,403].includes(e.status)){var r=(0,f.C5)(n,l.G.Administrator,"");t(r),P("not authorized")}else P("something went wrong")},i=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(t){var a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,u.V)().get("identify/roles",t,null,e);case 2:void 0!==(a=n.sent)&&(C(a.roles),Q(!0),te&&P("")),q(!1);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();!oe||J||K||(q(!0),i(n.credentials.access_tokens.administrator))}),[oe,t]),ie&&""===E&&te&&J?(0,de.jsx)(s.M5,{children:(0,de.jsx)(s.xu,{w:"container.xlg",h:"100%",children:(0,de.jsx)(me,{users:m,roles:y,setFilterText:O,page:S,setPage:B,totalPages:L})})}):ie&&""===E?(0,de.jsx)(s.M5,{h:"100%",children:(0,de.jsx)(ke.$,{id:"users-loadingSpinner"})}):(0,de.jsx)(s.M5,{id:"users-errorMessage",h:"100%",children:""===E?"not authorized":E})}}}]);
//# sourceMappingURL=489.c1834442.chunk.js.map