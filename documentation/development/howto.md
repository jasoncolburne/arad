[arad](../../../../) / [documentation](../) / [development](./)

# HOWTO

This document describes how to perform common tasks while developing ARAD.

## Convenience

There are a few scripts at the top of the repository that provide convenience methods for developers.

### Sync Script

This script synchronizes common code across the back-end services.

```
./sync
```

### Local Script

This script provides the ability to interact with the local stack.

#### build

This will build your docker images. It is required before `up`.

```
./local build
```

#### up

This starts a development stack. Healthchecks at each layer block the next from starting. Read docker-compose.yml for
more information.

```
./local up
```

#### down

This stops a development stack from another terminal, and removes the stack's containers if run a second time.

```
./local down
```

#### relock

This will update all the poetry.lock files in the backend. Warning: test well if you use this. Updating individual
solitary dependencies as required is much safer.

```
./local relock
```

#### be-exec

This will execute a command in all backend services.

```
./local be-exec poetry env info
```

#### prune

This will clean up some intermediate Docker images.

```
./local prune
```

#### rm

This will remove containers spawned by docker run without the --rm parameter.

```
./local rm
```

#### types

This will fetch type information from the OpenAPI definitions generated by the back-end and create types in the
front-end.

```
./local types
```

#### nuke

This command will reset a local Arad stack, recreating the database.

```
./local nuke
```

#### repl

This command starts an interactive shell in the back-end of your choice.

```
./local repl identity
```

### Database script

The `database` script provides access to common tasks involving the database.

#### create

This command will create a `PostgreSQL` database suitable for development and install the `pgcrypto` extension.

```
./database create
```

#### drop

This command will destroy the existing database.

```
./database drop
```

#### migrate

This command will run any pending migrations.

```
./database migrate
```

#### generate-migrations

This command will attept to generate new migrations from changes in `database/models.py`.

```
./database generate-migrations
```

#### empty-migration

This command will generate an empty migration for whatever purposes you may need.

```
./database empty-migration
```

## Common Tasks

### Adding a new dependency to all back-end stacks

```
./local be-exec poetry add <package> -vv
```

### Adding a new test or dev dependency to a single service

Here we add `black` to `identity`, as a `test` dependency, without installing.

```
docker compose run --rm be-identity poetry add black -vv --group test --lock
```
